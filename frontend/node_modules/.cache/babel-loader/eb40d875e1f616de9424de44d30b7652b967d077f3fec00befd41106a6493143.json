{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import Sidebar from'../components/Sidebar';import ChatBox from'../components/ChatBox';// ✅ Live Chat\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const TicketsPage=_ref=>{let{role,setUser}=_ref;const[tickets,setTickets]=useState([]);const[showForm,setShowForm]=useState(false);const[title,setTitle]=useState('');const[description,setDescription]=useState('');const[assignedEmail,setAssignedEmail]=useState('');const[currentUser,setCurrentUser]=useState(null);const[sortOption,setSortOption]=useState('latest');const[commentText,setCommentText]=useState('');const[commentingTicketId,setCommentingTicketId]=useState(null);const apiBase='https://leanflow.onrender.com';const[editingTicket,setEditingTicket]=useState(null);const[editTitle,setEditTitle]=useState('');const[editDescription,setEditDescription]=useState('');const[editAssignedEmail,setEditAssignedEmail]=useState('');const openEditModal=ticket=>{var _ticket$assignedTo;setEditingTicket(ticket);setEditTitle(ticket.title);setEditDescription(ticket.description);setEditAssignedEmail(((_ticket$assignedTo=ticket.assignedTo)===null||_ticket$assignedTo===void 0?void 0:_ticket$assignedTo.email)||'');};const fetchTickets=async()=>{try{const res=await axios.get('https://leanflow.onrender.com/api/tickets');const user=JSON.parse(localStorage.getItem('user'));setCurrentUser(user);let filtered=res.data;if(user.role==='client'){filtered=res.data.filter(t=>{var _t$createdBy,_t$assignedTo;return((_t$createdBy=t.createdBy)===null||_t$createdBy===void 0?void 0:_t$createdBy._id)===user.id||((_t$assignedTo=t.assignedTo)===null||_t$assignedTo===void 0?void 0:_t$assignedTo._id)===user.id;});}setTickets(filtered);}catch(err){console.error('❌ Failed to fetch tickets:',err);}};const handleSubmit=async e=>{e.preventDefault();try{const user=JSON.parse(localStorage.getItem('user'));await axios.post(\"\".concat(apiBase,\"/api/tickets\"),{title,description,assignedToEmail:assignedEmail,createdBy:user.id,status:'open'},{headers:{'x-user-email':user.email,'x-user-role':user.role}});setTitle('');setDescription('');setAssignedEmail('');setShowForm(false);fetchTickets();}catch(err){var _err$response;console.error('❌ Ticket creation failed:',((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message);alert('Failed to create ticket');}};const submitComment=async ticketId=>{try{const user=JSON.parse(localStorage.getItem('user'));if(!commentText.trim())return;await axios.post(\"\".concat(apiBase,\"/api/comments\"),{ticketId,authorId:user.id,message:commentText.trim()},{headers:{'x-user-email':user.email,'x-user-role':user.role}});setCommentText('');setCommentingTicketId(null);fetchTickets();}catch(err){console.error('❌ Failed to add comment:',err);alert('Failed to post comment');}};useEffect(()=>{fetchTickets();},[]);const sortedTickets=[...tickets].sort((a,b)=>{if(sortOption==='latest'){return new Date(b.createdAt)-new Date(a.createdAt);}else if(sortOption==='oldest'){return new Date(a.createdAt)-new Date(b.createdAt);}else if(sortOption==='status'){return a.status.localeCompare(b.status);}return 0;});const toggleComplete=async(ticketId,currentStatus)=>{const newStatus=currentStatus==='closed'?'open':'closed';try{await axios.put(\"\".concat(apiBase,\"/api/tickets/\").concat(ticketId),{status:newStatus});fetchTickets();}catch(err){console.error('❌ Failed to toggle status:',err);alert('Failed to update status');}};const deleteTicket=async id=>{if(!window.confirm('Are you sure you want to delete this ticket?'))return;try{await axios.delete(\"\".concat(apiBase,\"/api/tickets/\").concat(id),{headers:{'x-user-email':currentUser.email,'x-user-role':currentUser.role}});fetchTickets();}catch(err){console.error('❌ Failed to delete ticket:',err);alert('Failed to delete');}};const editTicket=ticket=>{openEditModal(ticket);};const handleEditSubmit=async()=>{if(!editTitle||!editDescription)return alert('Title and description required');try{const update={title:editTitle,description:editDescription,status:editingTicket.status};if(editAssignedEmail){const res=await axios.get(\"\".concat(apiBase,\"/api/users/by-email/\").concat(editAssignedEmail));update.assignedTo=res.data._id;}await axios.put(\"\".concat(apiBase,\"/api/tickets/\").concat(editingTicket._id),update);setEditingTicket(null);fetchTickets();}catch(err){console.error('❌ Edit failed:',err);alert('Failed to update ticket');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"flex h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white\",children:[/*#__PURE__*/_jsx(Sidebar,{role:role,setUser:setUser}),/*#__PURE__*/_jsxs(\"main\",{className:\"flex-1 p-6 overflow-y-auto relative\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold\",children:\"Tickets\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 dark:text-gray-400\",children:[\"Logged in as: \",/*#__PURE__*/_jsx(\"strong\",{children:role})]})]}),(role==='admin'||role==='support')&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowForm(!showForm),className:\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded\",children:showForm?'Cancel':'+ New Ticket'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 flex justify-end\",children:/*#__PURE__*/_jsxs(\"select\",{value:sortOption,onChange:e=>setSortOption(e.target.value),className:\"p-2 border rounded dark:bg-gray-800 dark:text-white\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"latest\",children:\"Latest\"}),/*#__PURE__*/_jsx(\"option\",{value:\"oldest\",children:\"Oldest\"}),/*#__PURE__*/_jsx(\"option\",{value:\"status\",children:\"By Status\"})]})}),showForm&&(role==='admin'||role==='support')&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4 max-w-md mb-8\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Ticket title\",value:title,onChange:e=>setTitle(e.target.value),required:true,className:\"w-full p-2 border rounded dark:bg-gray-800 dark:text-white\"}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Describe the issue...\",value:description,onChange:e=>setDescription(e.target.value),required:true,rows:4,className:\"w-full p-2 border rounded dark:bg-gray-800 dark:text-white\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Assign to (email)\",value:assignedEmail,onChange:e=>setAssignedEmail(e.target.value),className:\"w-full p-2 border rounded dark:bg-gray-800 dark:text-white\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded\",children:\"Submit Ticket\"})]}),sortedTickets.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 dark:text-gray-400\",children:\"No tickets found.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"grid gap-4\",children:sortedTickets.map(ticket=>{var _ticket$createdBy,_ticket$assignedTo2,_ticket$assignedTo3,_ticket$comments,_ticket$history,_ticket$assignedTo4;return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-xl bg-white dark:bg-gray-800 shadow flex flex-col gap-2 border border-gray-300 dark:border-gray-700\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"font-bold text-lg\",children:ticket.title||'Untitled Ticket'}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded text-xs font-semibold \\n          \".concat(ticket.status==='completed'?'bg-green-200 text-green-800':'bg-yellow-200 text-yellow-800'),children:ticket.status})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 dark:text-gray-300\",children:ticket.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500 dark:text-gray-400\",children:[\"\\uD83D\\uDCE4 Created by: \",/*#__PURE__*/_jsx(\"strong\",{children:((_ticket$createdBy=ticket.createdBy)===null||_ticket$createdBy===void 0?void 0:_ticket$createdBy.email)||'N/A'}),/*#__PURE__*/_jsx(\"br\",{}),\"\\uD83D\\uDCE5 Assigned to: \",/*#__PURE__*/_jsx(\"strong\",{children:((_ticket$assignedTo2=ticket.assignedTo)===null||_ticket$assignedTo2===void 0?void 0:_ticket$assignedTo2.email)||'Unassigned'}),/*#__PURE__*/_jsx(\"br\",{}),\"\\uD83D\\uDD53 Created: \",new Date(ticket.createdAt).toLocaleString(),/*#__PURE__*/_jsx(\"br\",{}),\"\\uD83D\\uDD04 Updated: \",new Date(ticket.updatedAt).toLocaleString()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-2 mt-2\",children:[(role==='admin'||role==='support'||((_ticket$assignedTo3=ticket.assignedTo)===null||_ticket$assignedTo3===void 0?void 0:_ticket$assignedTo3._id)===(currentUser===null||currentUser===void 0?void 0:currentUser.id))&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>toggleComplete(ticket,ticket.status),className:\"text-xs px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700\",children:ticket.status==='completed'?'↩️ Uncomplete':'✅ Complete'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>editTicket(ticket),className:\"text-xs px-3 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600\",children:\"\\u270F\\uFE0F Edit\"})]}),(role==='admin'||role==='support')&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteTicket(ticket._id),className:\"text-xs px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700\",children:\"\\uD83D\\uDDD1\\uFE0F Delete\"})]}),editingTicket&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg w-full max-w-md space-y-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold\",children:\"\\u270F\\uFE0F Edit Ticket\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"w-full p-2 border rounded dark:bg-gray-700 dark:text-white\",value:editTitle,onChange:e=>setEditTitle(e.target.value)}),/*#__PURE__*/_jsx(\"textarea\",{rows:4,className:\"w-full p-2 border rounded dark:bg-gray-700 dark:text-white\",value:editDescription,onChange:e=>setEditDescription(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Assign to (email)\",className:\"w-full p-2 border rounded dark:bg-gray-700 dark:text-white\",value:editAssignedEmail,onChange:e=>setEditAssignedEmail(e.target.value)}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-3 pt-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditingTicket(null),className:\"text-gray-500 hover:text-red-500\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleEditSubmit,className:\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded\",children:\"Save\"})]})]})}),((_ticket$comments=ticket.comments)===null||_ticket$comments===void 0?void 0:_ticket$comments.length)>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 border-t pt-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-semibold mb-1 text-gray-600 dark:text-gray-300\",children:\"\\uD83D\\uDCAC Comments:\"}),ticket.comments.map(comment=>{var _comment$author;return/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm\",children:[/*#__PURE__*/_jsxs(\"strong\",{children:[((_comment$author=comment.author)===null||_comment$author===void 0?void 0:_comment$author.name)||'Unknown',\":\"]}),\" \",comment.message]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-400 dark:text-gray-500\",children:[\"\\uD83D\\uDD53 \",new Date(comment.createdAt).toLocaleString()]})]},comment._id);}),ticket.updatedAt&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-400 dark:text-gray-500 mt-2\",children:[\"\\uD83D\\uDD04 Updated: \",new Date(ticket.updatedAt).toLocaleString()]}),((_ticket$history=ticket.history)===null||_ticket$history===void 0?void 0:_ticket$history.length)>0&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-400 dark:text-gray-500 mt-1\",children:[\"\\uD83D\\uDCDC History:\",ticket.history.slice(-3).map((h,idx)=>/*#__PURE__*/_jsxs(\"span\",{className:\"ml-1\",children:[h.type==='edit'&&'✏️',h.type==='complete'&&'✅',h.type==='reopen'&&'♻️',\" \",h.type,\" (\",new Date(h.timestamp).toLocaleTimeString(),\")\"]},idx))]})]}),(role==='admin'||role==='support'||((_ticket$assignedTo4=ticket.assignedTo)===null||_ticket$assignedTo4===void 0?void 0:_ticket$assignedTo4._id)===(currentUser===null||currentUser===void 0?void 0:currentUser.id))&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2\",children:[/*#__PURE__*/_jsx(\"textarea\",{rows:2,placeholder:\"Write a comment...\",value:commentingTicketId===ticket._id?commentText:'',onFocus:()=>setCommentingTicketId(ticket._id),onChange:e=>setCommentText(e.target.value),className:\"w-full p-2 border rounded dark:bg-gray-900 dark:text-white\"}),/*#__PURE__*/_jsx(\"button\",{className:\"mt-2 px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700\",onClick:()=>submitComment(ticket._id),children:\"\\uD83D\\uDCAC Add Comment\"})]})]},ticket._id);})}),currentUser&&/*#__PURE__*/_jsx(ChatBox,{user:currentUser})]})]});};export default TicketsPage;","map":{"version":3,"names":["React","useEffect","useState","axios","Sidebar","ChatBox","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","TicketsPage","_ref","role","setUser","tickets","setTickets","showForm","setShowForm","title","setTitle","description","setDescription","assignedEmail","setAssignedEmail","currentUser","setCurrentUser","sortOption","setSortOption","commentText","setCommentText","commentingTicketId","setCommentingTicketId","apiBase","editingTicket","setEditingTicket","editTitle","setEditTitle","editDescription","setEditDescription","editAssignedEmail","setEditAssignedEmail","openEditModal","ticket","_ticket$assignedTo","assignedTo","email","fetchTickets","res","get","user","JSON","parse","localStorage","getItem","filtered","data","filter","t","_t$createdBy","_t$assignedTo","createdBy","_id","id","err","console","error","handleSubmit","e","preventDefault","post","concat","assignedToEmail","status","headers","_err$response","response","message","alert","submitComment","ticketId","trim","authorId","sortedTickets","sort","a","b","Date","createdAt","localeCompare","toggleComplete","currentStatus","newStatus","put","deleteTicket","window","confirm","delete","editTicket","handleEditSubmit","update","className","children","onClick","value","onChange","target","onSubmit","type","placeholder","required","rows","length","map","_ticket$createdBy","_ticket$assignedTo2","_ticket$assignedTo3","_ticket$comments","_ticket$history","_ticket$assignedTo4","toLocaleString","updatedAt","comments","comment","_comment$author","author","name","history","slice","h","idx","timestamp","toLocaleTimeString","onFocus"],"sources":["/Users/varazdat.melkonyan/Desktop/LeanFlow/frontend/src/pages/TicketsPage.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Sidebar from '../components/Sidebar';\nimport ChatBox from '../components/ChatBox'; // ✅ Live Chat\n\nconst TicketsPage = ({ role, setUser }) => {\n  const [tickets, setTickets] = useState([]);\n  const [showForm, setShowForm] = useState(false);\n  const [title, setTitle] = useState('');\n  const [description, setDescription] = useState('');\n  const [assignedEmail, setAssignedEmail] = useState('');\n  const [currentUser, setCurrentUser] = useState(null);\n  const [sortOption, setSortOption] = useState('latest');\n  const [commentText, setCommentText] = useState('');\n  const [commentingTicketId, setCommentingTicketId] = useState(null);\n  const apiBase = 'https://leanflow.onrender.com';\n  const [editingTicket, setEditingTicket] = useState(null);\n  const [editTitle, setEditTitle] = useState('');\n  const [editDescription, setEditDescription] = useState('');\n  const [editAssignedEmail, setEditAssignedEmail] = useState('');\n\n  const openEditModal = (ticket) => {\n    setEditingTicket(ticket);\n    setEditTitle(ticket.title);\n    setEditDescription(ticket.description);\n    setEditAssignedEmail(ticket.assignedTo?.email || '');\n  };\n\n  const fetchTickets = async () => {\n    try {\n      const res = await axios.get('https://leanflow.onrender.com/api/tickets');\n      const user = JSON.parse(localStorage.getItem('user'));\n      setCurrentUser(user);\n\n\n      let filtered = res.data;\n      if (user.role === 'client') {\n        filtered = res.data.filter(t =>\n          t.createdBy?._id === user.id || t.assignedTo?._id === user.id\n        );\n      }\n\n      setTickets(filtered);\n    } catch (err) {\n      console.error('❌ Failed to fetch tickets:', err);\n    }\n  };\n\n  const handleSubmit = async (e) => {\n  e.preventDefault();\n  try {\n    const user = JSON.parse(localStorage.getItem('user'));\n\n    await axios.post(`${apiBase}/api/tickets`, {\n  title,\n  description,\n  assignedToEmail: assignedEmail,\n  createdBy: user.id,\n  status: 'open'\n}, {\n  headers: {\n    'x-user-email': user.email,\n    'x-user-role': user.role\n  }\n});\n    setTitle('');\n    setDescription('');\n    setAssignedEmail('');\n    setShowForm(false);\n    fetchTickets();\n  } catch (err) {\n    console.error('❌ Ticket creation failed:', err.response?.data || err.message);\n    alert('Failed to create ticket');\n  }\n};\n\n  const submitComment = async (ticketId) => {\n    try {\n      const user = JSON.parse(localStorage.getItem('user'));\n\n      if (!commentText.trim()) return;\n\n      await axios.post(`${apiBase}/api/comments`, {\n  ticketId,\n  authorId: user.id,\n  message: commentText.trim()\n}, {\n  headers: {\n    'x-user-email': user.email,\n    'x-user-role': user.role\n  }\n});\n\n      setCommentText('');\n      setCommentingTicketId(null);\n      fetchTickets();\n    } catch (err) {\n      console.error('❌ Failed to add comment:', err);\n      alert('Failed to post comment');\n    }\n  };\n\n  useEffect(() => {\n    fetchTickets();\n  }, []);\n\n  const sortedTickets = [...tickets].sort((a, b) => {\n    if (sortOption === 'latest') {\n      return new Date(b.createdAt) - new Date(a.createdAt);\n    } else if (sortOption === 'oldest') {\n      return new Date(a.createdAt) - new Date(b.createdAt);\n    } else if (sortOption === 'status') {\n      return a.status.localeCompare(b.status);\n    }\n    return 0;\n  });\n\n  const toggleComplete = async (ticketId, currentStatus) => {\n  const newStatus = currentStatus === 'closed' ? 'open' : 'closed';\n\n  try {\n    await axios.put(`${apiBase}/api/tickets/${ticketId}`, {\n      status: newStatus\n    });\n    fetchTickets();\n  } catch (err) {\n    console.error('❌ Failed to toggle status:', err);\n    alert('Failed to update status');\n  }\n};\n\nconst deleteTicket = async (id) => {\n  if (!window.confirm('Are you sure you want to delete this ticket?')) return;\n  try {\n    await axios.delete(`${apiBase}/api/tickets/${id}`, {\n      headers: {\n        'x-user-email': currentUser.email,\n        'x-user-role': currentUser.role\n      }\n    });\n    fetchTickets();\n  } catch (err) {\n    console.error('❌ Failed to delete ticket:', err);\n    alert('Failed to delete');\n  }\n};\n\nconst editTicket = (ticket) => {\n  openEditModal(ticket);\n};\n\nconst handleEditSubmit = async () => {\n  if (!editTitle || !editDescription) return alert('Title and description required');\n\n  try {\n    const update = {\n      title: editTitle,\n      description: editDescription,\n      status: editingTicket.status,\n    };\n\n    if (editAssignedEmail) {\n      const res = await axios.get(`${apiBase}/api/users/by-email/${editAssignedEmail}`);\n      update.assignedTo = res.data._id;\n    }\n\n    await axios.put(`${apiBase}/api/tickets/${editingTicket._id}`, update);\n    setEditingTicket(null);\n    fetchTickets();\n  } catch (err) {\n    console.error('❌ Edit failed:', err);\n    alert('Failed to update ticket');\n  }\n};\n\n\n  return (\n    <div className=\"flex h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white\">\n      <Sidebar role={role} setUser={setUser} />\n\n      <main className=\"flex-1 p-6 overflow-y-auto relative\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <div>\n            <h1 className=\"text-2xl font-bold\">Tickets</h1>\n            <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n              Logged in as: <strong>{role}</strong>\n            </p>\n          </div>\n\n          {(role === 'admin' || role === 'support') && (\n            <button\n              onClick={() => setShowForm(!showForm)}\n              className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded\"\n            >\n              {showForm ? 'Cancel' : '+ New Ticket'}\n            </button>\n          )}\n        </div>\n\n        <div className=\"mb-4 flex justify-end\">\n          <select\n            value={sortOption}\n            onChange={(e) => setSortOption(e.target.value)}\n            className=\"p-2 border rounded dark:bg-gray-800 dark:text-white\"\n          >\n            <option value=\"latest\">Latest</option>\n            <option value=\"oldest\">Oldest</option>\n            <option value=\"status\">By Status</option>\n          </select>\n        </div>\n\n        {showForm && (role === 'admin' || role === 'support') && (\n          <form onSubmit={handleSubmit} className=\"space-y-4 max-w-md mb-8\">\n            <input\n              type=\"text\"\n              placeholder=\"Ticket title\"\n              value={title}\n              onChange={(e) => setTitle(e.target.value)}\n              required\n              className=\"w-full p-2 border rounded dark:bg-gray-800 dark:text-white\"\n            />\n            <textarea\n              placeholder=\"Describe the issue...\"\n              value={description}\n              onChange={(e) => setDescription(e.target.value)}\n              required\n              rows={4}\n              className=\"w-full p-2 border rounded dark:bg-gray-800 dark:text-white\"\n            />\n            <input\n              type=\"email\"\n              placeholder=\"Assign to (email)\"\n              value={assignedEmail}\n              onChange={(e) => setAssignedEmail(e.target.value)}\n              className=\"w-full p-2 border rounded dark:bg-gray-800 dark:text-white\"\n            />\n            <button\n              type=\"submit\"\n              className=\"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded\"\n            >\n              Submit Ticket\n            </button>\n          </form>\n        )}\n\n        {sortedTickets.length === 0 ? (\n          <p className=\"text-sm text-gray-500 dark:text-gray-400\">No tickets found.</p>\n        ) : (\n          <div className=\"grid gap-4\">\n  {sortedTickets.map((ticket) => (\n    <div\n      key={ticket._id}\n      className=\"p-4 rounded-xl bg-white dark:bg-gray-800 shadow flex flex-col gap-2 border border-gray-300 dark:border-gray-700\"\n    >\n      <div className=\"flex justify-between items-center\">\n        <h2 className=\"font-bold text-lg\">{ticket.title || 'Untitled Ticket'}</h2>\n        <span className={`px-2 py-1 rounded text-xs font-semibold \n          ${ticket.status === 'completed' ? 'bg-green-200 text-green-800' : 'bg-yellow-200 text-yellow-800'}`}>\n          {ticket.status}\n        </span>\n      </div>\n\n      <p className=\"text-sm text-gray-600 dark:text-gray-300\">{ticket.description}</p>\n\n      <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n        📤 Created by: <strong>{ticket.createdBy?.email || 'N/A'}</strong><br />\n        📥 Assigned to: <strong>{ticket.assignedTo?.email || 'Unassigned'}</strong><br />\n        🕓 Created: {new Date(ticket.createdAt).toLocaleString()}<br />\n        🔄 Updated: {new Date(ticket.updatedAt).toLocaleString()}\n      </div>\n\n      <div className=\"flex flex-wrap gap-2 mt-2\">\n        {(role === 'admin' || role === 'support' || ticket.assignedTo?._id === currentUser?.id) && (\n          <>\n            <button\n              onClick={() => toggleComplete(ticket, ticket.status)}\n              className=\"text-xs px-3 py-1 rounded bg-blue-600 text-white hover:bg-blue-700\"\n            >\n              {ticket.status === 'completed' ? '↩️ Uncomplete' : '✅ Complete'}\n            </button>\n            <button\n              onClick={() => editTicket(ticket)}\n              className=\"text-xs px-3 py-1 rounded bg-yellow-500 text-white hover:bg-yellow-600\"\n            >\n              ✏️ Edit\n            </button>\n          </>\n        )}\n        {(role === 'admin' || role === 'support') && (\n          <button\n            onClick={() => deleteTicket(ticket._id)}\n            className=\"text-xs px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700\"\n          >\n            🗑️ Delete\n          </button>\n        )}\n      </div>\n      {editingTicket && (\n  <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n    <div className=\"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg w-full max-w-md space-y-4\">\n      <h2 className=\"text-xl font-semibold\">✏️ Edit Ticket</h2>\n\n      <input\n        type=\"text\"\n        className=\"w-full p-2 border rounded dark:bg-gray-700 dark:text-white\"\n        value={editTitle}\n        onChange={(e) => setEditTitle(e.target.value)}\n      />\n      <textarea\n        rows={4}\n        className=\"w-full p-2 border rounded dark:bg-gray-700 dark:text-white\"\n        value={editDescription}\n        onChange={(e) => setEditDescription(e.target.value)}\n      />\n      <input\n        type=\"email\"\n        placeholder=\"Assign to (email)\"\n        className=\"w-full p-2 border rounded dark:bg-gray-700 dark:text-white\"\n        value={editAssignedEmail}\n        onChange={(e) => setEditAssignedEmail(e.target.value)}\n      />\n\n      <div className=\"flex justify-end gap-3 pt-2\">\n        <button\n          onClick={() => setEditingTicket(null)}\n          className=\"text-gray-500 hover:text-red-500\"\n        >\n          Cancel\n        </button>\n        <button\n          onClick={handleEditSubmit}\n          className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded\"\n        >\n          Save\n        </button>\n      </div>\n    </div>\n  </div>\n)}\n\n      {ticket.comments?.length > 0 && (\n  <div className=\"mt-4 border-t pt-2\">\n    <h3 className=\"text-sm font-semibold mb-1 text-gray-600 dark:text-gray-300\">\n      💬 Comments:\n    </h3>\n    {ticket.comments.map((comment) => (\n      <div key={comment._id} className=\"mb-4\">\n        <p className=\"text-sm\">\n          <strong>{comment.author?.name || 'Unknown'}:</strong> {comment.message}\n        </p>\n        <p className=\"text-xs text-gray-400 dark:text-gray-500\">\n          🕓 {new Date(comment.createdAt).toLocaleString()}\n        </p>\n      </div>\n    ))}\n\n    {/* ✅ Show ticket-level updatedAt and history outside comments */}\n    {ticket.updatedAt && (\n      <p className=\"text-xs text-gray-400 dark:text-gray-500 mt-2\">\n        🔄 Updated: {new Date(ticket.updatedAt).toLocaleString()}\n      </p>\n    )}\n\n    {ticket.history?.length > 0 && (\n      <p className=\"text-xs text-gray-400 dark:text-gray-500 mt-1\">\n        📜 History:\n        {ticket.history.slice(-3).map((h, idx) => (\n          <span key={idx} className=\"ml-1\">\n            {h.type === 'edit' && '✏️'}\n            {h.type === 'complete' && '✅'}\n            {h.type === 'reopen' && '♻️'} {h.type} (\n            {new Date(h.timestamp).toLocaleTimeString()})\n          </span>\n        ))}\n      </p>\n    )}\n  </div>\n)}\n\n      {(role === 'admin' || role === 'support' || ticket.assignedTo?._id === currentUser?.id) && (\n        <div className=\"mt-2\">\n          <textarea\n            rows={2}\n            placeholder=\"Write a comment...\"\n            value={commentingTicketId === ticket._id ? commentText : ''}\n            onFocus={() => setCommentingTicketId(ticket._id)}\n            onChange={(e) => setCommentText(e.target.value)}\n            className=\"w-full p-2 border rounded dark:bg-gray-900 dark:text-white\"\n          />\n          <button\n            className=\"mt-2 px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700\"\n            onClick={() => submitComment(ticket._id)}\n          >\n            💬 Add Comment\n          </button>\n        </div>\n      )}\n    </div>\n  ))}\n</div>\n        )}\n\n        {currentUser && <ChatBox user={currentUser} />}\n        \n      </main>\n    </div>\n  );\n};\n\nexport default TicketsPage;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,OAAO,KAAM,uBAAuB,CAC3C,MAAO,CAAAC,OAAO,KAAM,uBAAuB,CAAE;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE7C,KAAM,CAAAC,WAAW,CAAGC,IAAA,EAAuB,IAAtB,CAAEC,IAAI,CAAEC,OAAQ,CAAC,CAAAF,IAAA,CACpC,KAAM,CAACG,OAAO,CAAEC,UAAU,CAAC,CAAGf,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACgB,QAAQ,CAAEC,WAAW,CAAC,CAAGjB,QAAQ,CAAC,KAAK,CAAC,CAC/C,KAAM,CAACkB,KAAK,CAAEC,QAAQ,CAAC,CAAGnB,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACoB,WAAW,CAAEC,cAAc,CAAC,CAAGrB,QAAQ,CAAC,EAAE,CAAC,CAClD,KAAM,CAACsB,aAAa,CAAEC,gBAAgB,CAAC,CAAGvB,QAAQ,CAAC,EAAE,CAAC,CACtD,KAAM,CAACwB,WAAW,CAAEC,cAAc,CAAC,CAAGzB,QAAQ,CAAC,IAAI,CAAC,CACpD,KAAM,CAAC0B,UAAU,CAAEC,aAAa,CAAC,CAAG3B,QAAQ,CAAC,QAAQ,CAAC,CACtD,KAAM,CAAC4B,WAAW,CAAEC,cAAc,CAAC,CAAG7B,QAAQ,CAAC,EAAE,CAAC,CAClD,KAAM,CAAC8B,kBAAkB,CAAEC,qBAAqB,CAAC,CAAG/B,QAAQ,CAAC,IAAI,CAAC,CAClE,KAAM,CAAAgC,OAAO,CAAG,+BAA+B,CAC/C,KAAM,CAACC,aAAa,CAAEC,gBAAgB,CAAC,CAAGlC,QAAQ,CAAC,IAAI,CAAC,CACxD,KAAM,CAACmC,SAAS,CAAEC,YAAY,CAAC,CAAGpC,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACqC,eAAe,CAAEC,kBAAkB,CAAC,CAAGtC,QAAQ,CAAC,EAAE,CAAC,CAC1D,KAAM,CAACuC,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGxC,QAAQ,CAAC,EAAE,CAAC,CAE9D,KAAM,CAAAyC,aAAa,CAAIC,MAAM,EAAK,KAAAC,kBAAA,CAChCT,gBAAgB,CAACQ,MAAM,CAAC,CACxBN,YAAY,CAACM,MAAM,CAACxB,KAAK,CAAC,CAC1BoB,kBAAkB,CAACI,MAAM,CAACtB,WAAW,CAAC,CACtCoB,oBAAoB,CAAC,EAAAG,kBAAA,CAAAD,MAAM,CAACE,UAAU,UAAAD,kBAAA,iBAAjBA,kBAAA,CAAmBE,KAAK,GAAI,EAAE,CAAC,CACtD,CAAC,CAED,KAAM,CAAAC,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAA9C,KAAK,CAAC+C,GAAG,CAAC,2CAA2C,CAAC,CACxE,KAAM,CAAAC,IAAI,CAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC,CACrD5B,cAAc,CAACwB,IAAI,CAAC,CAGpB,GAAI,CAAAK,QAAQ,CAAGP,GAAG,CAACQ,IAAI,CACvB,GAAIN,IAAI,CAACrC,IAAI,GAAK,QAAQ,CAAE,CAC1B0C,QAAQ,CAAGP,GAAG,CAACQ,IAAI,CAACC,MAAM,CAACC,CAAC,OAAAC,YAAA,CAAAC,aAAA,OAC1B,EAAAD,YAAA,CAAAD,CAAC,CAACG,SAAS,UAAAF,YAAA,iBAAXA,YAAA,CAAaG,GAAG,IAAKZ,IAAI,CAACa,EAAE,EAAI,EAAAH,aAAA,CAAAF,CAAC,CAACb,UAAU,UAAAe,aAAA,iBAAZA,aAAA,CAAcE,GAAG,IAAKZ,IAAI,CAACa,EAAE,EAC/D,CAAC,CACH,CAEA/C,UAAU,CAACuC,QAAQ,CAAC,CACtB,CAAE,MAAOS,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,4BAA4B,CAAEF,GAAG,CAAC,CAClD,CACF,CAAC,CAED,KAAM,CAAAG,YAAY,CAAG,KAAO,CAAAC,CAAC,EAAK,CAClCA,CAAC,CAACC,cAAc,CAAC,CAAC,CAClB,GAAI,CACF,KAAM,CAAAnB,IAAI,CAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC,CAErD,KAAM,CAAApD,KAAK,CAACoE,IAAI,IAAAC,MAAA,CAAItC,OAAO,iBAAgB,CAC7Cd,KAAK,CACLE,WAAW,CACXmD,eAAe,CAAEjD,aAAa,CAC9BsC,SAAS,CAAEX,IAAI,CAACa,EAAE,CAClBU,MAAM,CAAE,MACV,CAAC,CAAE,CACDC,OAAO,CAAE,CACP,cAAc,CAAExB,IAAI,CAACJ,KAAK,CAC1B,aAAa,CAAEI,IAAI,CAACrC,IACtB,CACF,CAAC,CAAC,CACEO,QAAQ,CAAC,EAAE,CAAC,CACZE,cAAc,CAAC,EAAE,CAAC,CAClBE,gBAAgB,CAAC,EAAE,CAAC,CACpBN,WAAW,CAAC,KAAK,CAAC,CAClB6B,YAAY,CAAC,CAAC,CAChB,CAAE,MAAOiB,GAAG,CAAE,KAAAW,aAAA,CACZV,OAAO,CAACC,KAAK,CAAC,2BAA2B,CAAE,EAAAS,aAAA,CAAAX,GAAG,CAACY,QAAQ,UAAAD,aAAA,iBAAZA,aAAA,CAAcnB,IAAI,GAAIQ,GAAG,CAACa,OAAO,CAAC,CAC7EC,KAAK,CAAC,yBAAyB,CAAC,CAClC,CACF,CAAC,CAEC,KAAM,CAAAC,aAAa,CAAG,KAAO,CAAAC,QAAQ,EAAK,CACxC,GAAI,CACF,KAAM,CAAA9B,IAAI,CAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC,CAErD,GAAI,CAACzB,WAAW,CAACoD,IAAI,CAAC,CAAC,CAAE,OAEzB,KAAM,CAAA/E,KAAK,CAACoE,IAAI,IAAAC,MAAA,CAAItC,OAAO,kBAAiB,CAChD+C,QAAQ,CACRE,QAAQ,CAAEhC,IAAI,CAACa,EAAE,CACjBc,OAAO,CAAEhD,WAAW,CAACoD,IAAI,CAAC,CAC5B,CAAC,CAAE,CACDP,OAAO,CAAE,CACP,cAAc,CAAExB,IAAI,CAACJ,KAAK,CAC1B,aAAa,CAAEI,IAAI,CAACrC,IACtB,CACF,CAAC,CAAC,CAEIiB,cAAc,CAAC,EAAE,CAAC,CAClBE,qBAAqB,CAAC,IAAI,CAAC,CAC3Be,YAAY,CAAC,CAAC,CAChB,CAAE,MAAOiB,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,0BAA0B,CAAEF,GAAG,CAAC,CAC9Cc,KAAK,CAAC,wBAAwB,CAAC,CACjC,CACF,CAAC,CAED9E,SAAS,CAAC,IAAM,CACd+C,YAAY,CAAC,CAAC,CAChB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAoC,aAAa,CAAG,CAAC,GAAGpE,OAAO,CAAC,CAACqE,IAAI,CAAC,CAACC,CAAC,CAAEC,CAAC,GAAK,CAChD,GAAI3D,UAAU,GAAK,QAAQ,CAAE,CAC3B,MAAO,IAAI,CAAA4D,IAAI,CAACD,CAAC,CAACE,SAAS,CAAC,CAAG,GAAI,CAAAD,IAAI,CAACF,CAAC,CAACG,SAAS,CAAC,CACtD,CAAC,IAAM,IAAI7D,UAAU,GAAK,QAAQ,CAAE,CAClC,MAAO,IAAI,CAAA4D,IAAI,CAACF,CAAC,CAACG,SAAS,CAAC,CAAG,GAAI,CAAAD,IAAI,CAACD,CAAC,CAACE,SAAS,CAAC,CACtD,CAAC,IAAM,IAAI7D,UAAU,GAAK,QAAQ,CAAE,CAClC,MAAO,CAAA0D,CAAC,CAACZ,MAAM,CAACgB,aAAa,CAACH,CAAC,CAACb,MAAM,CAAC,CACzC,CACA,MAAO,EAAC,CACV,CAAC,CAAC,CAEF,KAAM,CAAAiB,cAAc,CAAG,KAAAA,CAAOV,QAAQ,CAAEW,aAAa,GAAK,CAC1D,KAAM,CAAAC,SAAS,CAAGD,aAAa,GAAK,QAAQ,CAAG,MAAM,CAAG,QAAQ,CAEhE,GAAI,CACF,KAAM,CAAAzF,KAAK,CAAC2F,GAAG,IAAAtB,MAAA,CAAItC,OAAO,kBAAAsC,MAAA,CAAgBS,QAAQ,EAAI,CACpDP,MAAM,CAAEmB,SACV,CAAC,CAAC,CACF7C,YAAY,CAAC,CAAC,CAChB,CAAE,MAAOiB,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,4BAA4B,CAAEF,GAAG,CAAC,CAChDc,KAAK,CAAC,yBAAyB,CAAC,CAClC,CACF,CAAC,CAED,KAAM,CAAAgB,YAAY,CAAG,KAAO,CAAA/B,EAAE,EAAK,CACjC,GAAI,CAACgC,MAAM,CAACC,OAAO,CAAC,8CAA8C,CAAC,CAAE,OACrE,GAAI,CACF,KAAM,CAAA9F,KAAK,CAAC+F,MAAM,IAAA1B,MAAA,CAAItC,OAAO,kBAAAsC,MAAA,CAAgBR,EAAE,EAAI,CACjDW,OAAO,CAAE,CACP,cAAc,CAAEjD,WAAW,CAACqB,KAAK,CACjC,aAAa,CAAErB,WAAW,CAACZ,IAC7B,CACF,CAAC,CAAC,CACFkC,YAAY,CAAC,CAAC,CAChB,CAAE,MAAOiB,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,4BAA4B,CAAEF,GAAG,CAAC,CAChDc,KAAK,CAAC,kBAAkB,CAAC,CAC3B,CACF,CAAC,CAED,KAAM,CAAAoB,UAAU,CAAIvD,MAAM,EAAK,CAC7BD,aAAa,CAACC,MAAM,CAAC,CACvB,CAAC,CAED,KAAM,CAAAwD,gBAAgB,CAAG,KAAAA,CAAA,GAAY,CACnC,GAAI,CAAC/D,SAAS,EAAI,CAACE,eAAe,CAAE,MAAO,CAAAwC,KAAK,CAAC,gCAAgC,CAAC,CAElF,GAAI,CACF,KAAM,CAAAsB,MAAM,CAAG,CACbjF,KAAK,CAAEiB,SAAS,CAChBf,WAAW,CAAEiB,eAAe,CAC5BmC,MAAM,CAAEvC,aAAa,CAACuC,MACxB,CAAC,CAED,GAAIjC,iBAAiB,CAAE,CACrB,KAAM,CAAAQ,GAAG,CAAG,KAAM,CAAA9C,KAAK,CAAC+C,GAAG,IAAAsB,MAAA,CAAItC,OAAO,yBAAAsC,MAAA,CAAuB/B,iBAAiB,CAAE,CAAC,CACjF4D,MAAM,CAACvD,UAAU,CAAGG,GAAG,CAACQ,IAAI,CAACM,GAAG,CAClC,CAEA,KAAM,CAAA5D,KAAK,CAAC2F,GAAG,IAAAtB,MAAA,CAAItC,OAAO,kBAAAsC,MAAA,CAAgBrC,aAAa,CAAC4B,GAAG,EAAIsC,MAAM,CAAC,CACtEjE,gBAAgB,CAAC,IAAI,CAAC,CACtBY,YAAY,CAAC,CAAC,CAChB,CAAE,MAAOiB,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,gBAAgB,CAAEF,GAAG,CAAC,CACpCc,KAAK,CAAC,yBAAyB,CAAC,CAClC,CACF,CAAC,CAGC,mBACEtE,KAAA,QAAK6F,SAAS,CAAC,0EAA0E,CAAAC,QAAA,eACvFhG,IAAA,CAACH,OAAO,EAACU,IAAI,CAAEA,IAAK,CAACC,OAAO,CAAEA,OAAQ,CAAE,CAAC,cAEzCN,KAAA,SAAM6F,SAAS,CAAC,qCAAqC,CAAAC,QAAA,eACnD9F,KAAA,QAAK6F,SAAS,CAAC,wCAAwC,CAAAC,QAAA,eACrD9F,KAAA,QAAA8F,QAAA,eACEhG,IAAA,OAAI+F,SAAS,CAAC,oBAAoB,CAAAC,QAAA,CAAC,SAAO,CAAI,CAAC,cAC/C9F,KAAA,MAAG6F,SAAS,CAAC,0CAA0C,CAAAC,QAAA,EAAC,gBACxC,cAAAhG,IAAA,WAAAgG,QAAA,CAASzF,IAAI,CAAS,CAAC,EACpC,CAAC,EACD,CAAC,CAEL,CAACA,IAAI,GAAK,OAAO,EAAIA,IAAI,GAAK,SAAS,gBACtCP,IAAA,WACEiG,OAAO,CAAEA,CAAA,GAAMrF,WAAW,CAAC,CAACD,QAAQ,CAAE,CACtCoF,SAAS,CAAC,4DAA4D,CAAAC,QAAA,CAErErF,QAAQ,CAAG,QAAQ,CAAG,cAAc,CAC/B,CACT,EACE,CAAC,cAENX,IAAA,QAAK+F,SAAS,CAAC,uBAAuB,CAAAC,QAAA,cACpC9F,KAAA,WACEgG,KAAK,CAAE7E,UAAW,CAClB8E,QAAQ,CAAGrC,CAAC,EAAKxC,aAAa,CAACwC,CAAC,CAACsC,MAAM,CAACF,KAAK,CAAE,CAC/CH,SAAS,CAAC,qDAAqD,CAAAC,QAAA,eAE/DhG,IAAA,WAAQkG,KAAK,CAAC,QAAQ,CAAAF,QAAA,CAAC,QAAM,CAAQ,CAAC,cACtChG,IAAA,WAAQkG,KAAK,CAAC,QAAQ,CAAAF,QAAA,CAAC,QAAM,CAAQ,CAAC,cACtChG,IAAA,WAAQkG,KAAK,CAAC,QAAQ,CAAAF,QAAA,CAAC,WAAS,CAAQ,CAAC,EACnC,CAAC,CACN,CAAC,CAELrF,QAAQ,GAAKJ,IAAI,GAAK,OAAO,EAAIA,IAAI,GAAK,SAAS,CAAC,eACnDL,KAAA,SAAMmG,QAAQ,CAAExC,YAAa,CAACkC,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eAC/DhG,IAAA,UACEsG,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,cAAc,CAC1BL,KAAK,CAAErF,KAAM,CACbsF,QAAQ,CAAGrC,CAAC,EAAKhD,QAAQ,CAACgD,CAAC,CAACsC,MAAM,CAACF,KAAK,CAAE,CAC1CM,QAAQ,MACRT,SAAS,CAAC,4DAA4D,CACvE,CAAC,cACF/F,IAAA,aACEuG,WAAW,CAAC,uBAAuB,CACnCL,KAAK,CAAEnF,WAAY,CACnBoF,QAAQ,CAAGrC,CAAC,EAAK9C,cAAc,CAAC8C,CAAC,CAACsC,MAAM,CAACF,KAAK,CAAE,CAChDM,QAAQ,MACRC,IAAI,CAAE,CAAE,CACRV,SAAS,CAAC,4DAA4D,CACvE,CAAC,cACF/F,IAAA,UACEsG,IAAI,CAAC,OAAO,CACZC,WAAW,CAAC,mBAAmB,CAC/BL,KAAK,CAAEjF,aAAc,CACrBkF,QAAQ,CAAGrC,CAAC,EAAK5C,gBAAgB,CAAC4C,CAAC,CAACsC,MAAM,CAACF,KAAK,CAAE,CAClDH,SAAS,CAAC,4DAA4D,CACvE,CAAC,cACF/F,IAAA,WACEsG,IAAI,CAAC,QAAQ,CACbP,SAAS,CAAC,8DAA8D,CAAAC,QAAA,CACzE,eAED,CAAQ,CAAC,EACL,CACP,CAEAnB,aAAa,CAAC6B,MAAM,GAAK,CAAC,cACzB1G,IAAA,MAAG+F,SAAS,CAAC,0CAA0C,CAAAC,QAAA,CAAC,mBAAiB,CAAG,CAAC,cAE7EhG,IAAA,QAAK+F,SAAS,CAAC,YAAY,CAAAC,QAAA,CAClCnB,aAAa,CAAC8B,GAAG,CAAEtE,MAAM,OAAAuE,iBAAA,CAAAC,mBAAA,CAAAC,mBAAA,CAAAC,gBAAA,CAAAC,eAAA,CAAAC,mBAAA,oBACxB/G,KAAA,QAEE6F,SAAS,CAAC,iHAAiH,CAAAC,QAAA,eAE3H9F,KAAA,QAAK6F,SAAS,CAAC,mCAAmC,CAAAC,QAAA,eAChDhG,IAAA,OAAI+F,SAAS,CAAC,mBAAmB,CAAAC,QAAA,CAAE3D,MAAM,CAACxB,KAAK,EAAI,iBAAiB,CAAK,CAAC,cAC1Eb,IAAA,SAAM+F,SAAS,wDAAA9B,MAAA,CACX5B,MAAM,CAAC8B,MAAM,GAAK,WAAW,CAAG,6BAA6B,CAAG,+BAA+B,CAAG,CAAA6B,QAAA,CACnG3D,MAAM,CAAC8B,MAAM,CACV,CAAC,EACJ,CAAC,cAENnE,IAAA,MAAG+F,SAAS,CAAC,0CAA0C,CAAAC,QAAA,CAAE3D,MAAM,CAACtB,WAAW,CAAI,CAAC,cAEhFb,KAAA,QAAK6F,SAAS,CAAC,0CAA0C,CAAAC,QAAA,EAAC,2BACzC,cAAAhG,IAAA,WAAAgG,QAAA,CAAS,EAAAY,iBAAA,CAAAvE,MAAM,CAACkB,SAAS,UAAAqD,iBAAA,iBAAhBA,iBAAA,CAAkBpE,KAAK,GAAI,KAAK,CAAS,CAAC,cAAAxC,IAAA,QAAK,CAAC,6BACxD,cAAAA,IAAA,WAAAgG,QAAA,CAAS,EAAAa,mBAAA,CAAAxE,MAAM,CAACE,UAAU,UAAAsE,mBAAA,iBAAjBA,mBAAA,CAAmBrE,KAAK,GAAI,YAAY,CAAS,CAAC,cAAAxC,IAAA,QAAK,CAAC,yBACrE,CAAC,GAAI,CAAAiF,IAAI,CAAC5C,MAAM,CAAC6C,SAAS,CAAC,CAACgC,cAAc,CAAC,CAAC,cAAClH,IAAA,QAAK,CAAC,yBACnD,CAAC,GAAI,CAAAiF,IAAI,CAAC5C,MAAM,CAAC8E,SAAS,CAAC,CAACD,cAAc,CAAC,CAAC,EACrD,CAAC,cAENhH,KAAA,QAAK6F,SAAS,CAAC,2BAA2B,CAAAC,QAAA,EACvC,CAACzF,IAAI,GAAK,OAAO,EAAIA,IAAI,GAAK,SAAS,EAAI,EAAAuG,mBAAA,CAAAzE,MAAM,CAACE,UAAU,UAAAuE,mBAAA,iBAAjBA,mBAAA,CAAmBtD,GAAG,KAAKrC,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEsC,EAAE,iBACpFvD,KAAA,CAAAE,SAAA,EAAA4F,QAAA,eACEhG,IAAA,WACEiG,OAAO,CAAEA,CAAA,GAAMb,cAAc,CAAC/C,MAAM,CAAEA,MAAM,CAAC8B,MAAM,CAAE,CACrD4B,SAAS,CAAC,oEAAoE,CAAAC,QAAA,CAE7E3D,MAAM,CAAC8B,MAAM,GAAK,WAAW,CAAG,eAAe,CAAG,YAAY,CACzD,CAAC,cACTnE,IAAA,WACEiG,OAAO,CAAEA,CAAA,GAAML,UAAU,CAACvD,MAAM,CAAE,CAClC0D,SAAS,CAAC,wEAAwE,CAAAC,QAAA,CACnF,mBAED,CAAQ,CAAC,EACT,CACH,CACA,CAACzF,IAAI,GAAK,OAAO,EAAIA,IAAI,GAAK,SAAS,gBACtCP,IAAA,WACEiG,OAAO,CAAEA,CAAA,GAAMT,YAAY,CAACnD,MAAM,CAACmB,GAAG,CAAE,CACxCuC,SAAS,CAAC,kEAAkE,CAAAC,QAAA,CAC7E,2BAED,CAAQ,CACT,EACE,CAAC,CACLpE,aAAa,eAClB5B,IAAA,QAAK+F,SAAS,CAAC,4EAA4E,CAAAC,QAAA,cACzF9F,KAAA,QAAK6F,SAAS,CAAC,8EAA8E,CAAAC,QAAA,eAC3FhG,IAAA,OAAI+F,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAC,0BAAc,CAAI,CAAC,cAEzDhG,IAAA,UACEsG,IAAI,CAAC,MAAM,CACXP,SAAS,CAAC,4DAA4D,CACtEG,KAAK,CAAEpE,SAAU,CACjBqE,QAAQ,CAAGrC,CAAC,EAAK/B,YAAY,CAAC+B,CAAC,CAACsC,MAAM,CAACF,KAAK,CAAE,CAC/C,CAAC,cACFlG,IAAA,aACEyG,IAAI,CAAE,CAAE,CACRV,SAAS,CAAC,4DAA4D,CACtEG,KAAK,CAAElE,eAAgB,CACvBmE,QAAQ,CAAGrC,CAAC,EAAK7B,kBAAkB,CAAC6B,CAAC,CAACsC,MAAM,CAACF,KAAK,CAAE,CACrD,CAAC,cACFlG,IAAA,UACEsG,IAAI,CAAC,OAAO,CACZC,WAAW,CAAC,mBAAmB,CAC/BR,SAAS,CAAC,4DAA4D,CACtEG,KAAK,CAAEhE,iBAAkB,CACzBiE,QAAQ,CAAGrC,CAAC,EAAK3B,oBAAoB,CAAC2B,CAAC,CAACsC,MAAM,CAACF,KAAK,CAAE,CACvD,CAAC,cAEFhG,KAAA,QAAK6F,SAAS,CAAC,6BAA6B,CAAAC,QAAA,eAC1ChG,IAAA,WACEiG,OAAO,CAAEA,CAAA,GAAMpE,gBAAgB,CAAC,IAAI,CAAE,CACtCkE,SAAS,CAAC,kCAAkC,CAAAC,QAAA,CAC7C,QAED,CAAQ,CAAC,cACThG,IAAA,WACEiG,OAAO,CAAEJ,gBAAiB,CAC1BE,SAAS,CAAC,4DAA4D,CAAAC,QAAA,CACvE,MAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,CACH,CACN,CAEM,EAAAe,gBAAA,CAAA1E,MAAM,CAAC+E,QAAQ,UAAAL,gBAAA,iBAAfA,gBAAA,CAAiBL,MAAM,EAAG,CAAC,eAChCxG,KAAA,QAAK6F,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eACjChG,IAAA,OAAI+F,SAAS,CAAC,6DAA6D,CAAAC,QAAA,CAAC,wBAE5E,CAAI,CAAC,CACJ3D,MAAM,CAAC+E,QAAQ,CAACT,GAAG,CAAEU,OAAO,OAAAC,eAAA,oBAC3BpH,KAAA,QAAuB6F,SAAS,CAAC,MAAM,CAAAC,QAAA,eACrC9F,KAAA,MAAG6F,SAAS,CAAC,SAAS,CAAAC,QAAA,eACpB9F,KAAA,WAAA8F,QAAA,EAAS,EAAAsB,eAAA,CAAAD,OAAO,CAACE,MAAM,UAAAD,eAAA,iBAAdA,eAAA,CAAgBE,IAAI,GAAI,SAAS,CAAC,GAAC,EAAQ,CAAC,IAAC,CAACH,OAAO,CAAC9C,OAAO,EACrE,CAAC,cACJrE,KAAA,MAAG6F,SAAS,CAAC,0CAA0C,CAAAC,QAAA,EAAC,eACnD,CAAC,GAAI,CAAAf,IAAI,CAACoC,OAAO,CAACnC,SAAS,CAAC,CAACgC,cAAc,CAAC,CAAC,EAC/C,CAAC,GANIG,OAAO,CAAC7D,GAOb,CAAC,EACP,CAAC,CAGDnB,MAAM,CAAC8E,SAAS,eACfjH,KAAA,MAAG6F,SAAS,CAAC,+CAA+C,CAAAC,QAAA,EAAC,wBAC/C,CAAC,GAAI,CAAAf,IAAI,CAAC5C,MAAM,CAAC8E,SAAS,CAAC,CAACD,cAAc,CAAC,CAAC,EACvD,CACJ,CAEA,EAAAF,eAAA,CAAA3E,MAAM,CAACoF,OAAO,UAAAT,eAAA,iBAAdA,eAAA,CAAgBN,MAAM,EAAG,CAAC,eACzBxG,KAAA,MAAG6F,SAAS,CAAC,+CAA+C,CAAAC,QAAA,EAAC,uBAE3D,CAAC3D,MAAM,CAACoF,OAAO,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAACf,GAAG,CAAC,CAACgB,CAAC,CAAEC,GAAG,gBACnC1H,KAAA,SAAgB6F,SAAS,CAAC,MAAM,CAAAC,QAAA,EAC7B2B,CAAC,CAACrB,IAAI,GAAK,MAAM,EAAI,IAAI,CACzBqB,CAAC,CAACrB,IAAI,GAAK,UAAU,EAAI,GAAG,CAC5BqB,CAAC,CAACrB,IAAI,GAAK,QAAQ,EAAI,IAAI,CAAC,GAAC,CAACqB,CAAC,CAACrB,IAAI,CAAC,IACtC,CAAC,GAAI,CAAArB,IAAI,CAAC0C,CAAC,CAACE,SAAS,CAAC,CAACC,kBAAkB,CAAC,CAAC,CAAC,GAC9C,GALWF,GAKL,CACP,CAAC,EACD,CACJ,EACE,CACN,CAEM,CAACrH,IAAI,GAAK,OAAO,EAAIA,IAAI,GAAK,SAAS,EAAI,EAAA0G,mBAAA,CAAA5E,MAAM,CAACE,UAAU,UAAA0E,mBAAA,iBAAjBA,mBAAA,CAAmBzD,GAAG,KAAKrC,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEsC,EAAE,iBACpFvD,KAAA,QAAK6F,SAAS,CAAC,MAAM,CAAAC,QAAA,eACnBhG,IAAA,aACEyG,IAAI,CAAE,CAAE,CACRF,WAAW,CAAC,oBAAoB,CAChCL,KAAK,CAAEzE,kBAAkB,GAAKY,MAAM,CAACmB,GAAG,CAAGjC,WAAW,CAAG,EAAG,CAC5DwG,OAAO,CAAEA,CAAA,GAAMrG,qBAAqB,CAACW,MAAM,CAACmB,GAAG,CAAE,CACjD2C,QAAQ,CAAGrC,CAAC,EAAKtC,cAAc,CAACsC,CAAC,CAACsC,MAAM,CAACF,KAAK,CAAE,CAChDH,SAAS,CAAC,4DAA4D,CACvE,CAAC,cACF/F,IAAA,WACE+F,SAAS,CAAC,yEAAyE,CACnFE,OAAO,CAAEA,CAAA,GAAMxB,aAAa,CAACpC,MAAM,CAACmB,GAAG,CAAE,CAAAwC,QAAA,CAC1C,0BAED,CAAQ,CAAC,EACN,CACN,GAjJI3D,MAAM,CAACmB,GAkJT,CAAC,EACP,CAAC,CACC,CACI,CAEArC,WAAW,eAAInB,IAAA,CAACF,OAAO,EAAC8C,IAAI,CAAEzB,WAAY,CAAE,CAAC,EAE1C,CAAC,EACJ,CAAC,CAEV,CAAC,CAED,cAAe,CAAAd,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}